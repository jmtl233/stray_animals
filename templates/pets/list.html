{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/pet-list.css' %}">
{% endblock %}

{% block content %}
<div class="pet-list-container">
    <div class="list-header">
        <h1>寻找您的爱心伙伴</h1>
        <div class="filter-controls">
            <form method="get" class="filter-form">
                <div class="form-group">
                    <select name="breed" class="breed-select" onchange="this.form.submit()">
                        <option value="">所有品种</option>
                        {% for breed in breeds %}
                        <option value="{{ breed }}" {% if request.GET.breed == breed %}selected{% endif %}>{{ breed }}</option>
                        {% endfor %}
                    </select>
                    <div class="select-arrow"></div>
                </div>
            </form>
        </div>
    </div>

    <div class="pet-grid">
        <!-- 这里应该有宠物列表，但是只有注释 -->
        {% for pet in pets %}
        <div class="pet-card">
            <div class="pet-image-container">
                <img src="{{ pet.photo.url }}" alt="{{ pet.name }}" class="pet-image">
                <div class="pet-status">
                    {% if pet.is_vaccinated %}<span class="status-tag vaccinated">已接种</span>{% endif %}
                    {% if pet.is_neutered %}<span class="status-tag neutered">已绝育</span>{% endif %}
                </div>
            </div>
            <div class="pet-info">
                <h3>{{ pet.name }}</h3>
                <p class="pet-breed">{{ pet.breed }}</p>
                <p class="pet-meta">{{ pet.get_gender_display }} · {{ pet.age }}岁</p>
                <a href="{% url 'pets:detail' pet.id %}" class="pet-btn">查看详情</a>
            </div>
        </div>
        {% empty %}
        <div class="no-pets-message">
            <p>抱歉，目前没有符合条件的待领养宠物。</p>
            <p>请稍后再来查看，或者调整筛选条件。</p>
        </div>
        {% endfor %}
    </div>

    {# 统一样式分页组件 #}
    <div class="pagination-wrapper">
        {% if page_obj.paginator.num_pages > 1 %}
        <div class="pagination-container">
            {% if page_obj.has_previous %}
                <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.breed %}&breed={{ request.GET.breed }}{% endif %}" class="page-btn prev-page" title="上一页">
                    <i class="fas fa-angle-left"></i> 上一页
                </a>
                <a href="?page=1{% if request.GET.breed %}&breed={{ request.GET.breed }}{% endif %}" class="page-btn first-page" title="首页">
                    首页
                </a>
            {% endif %}
            
            <div class="page-numbers">
                {% for i in page_obj.paginator.page_range %}
                    {% if page_obj.number == i %}
                        <span class="page-btn current">{{ i }}</span>
                    {% elif i > page_obj.number|add:"-3" and i < page_obj.number|add:"3" %}
                        <a href="?page={{ i }}{% if request.GET.breed %}&breed={{ request.GET.breed }}{% endif %}" class="page-btn">{{ i }}</a>
                    {% endif %}
                {% endfor %}
            </div>
            
            {% if page_obj.has_next %}
                <a href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.breed %}&breed={{ request.GET.breed }}{% endif %}" class="page-btn last-page" title="末页">
                    末页
                </a>
                <a href="?page={{ page_obj.next_page_number }}{% if request.GET.breed %}&breed={{ request.GET.breed }}{% endif %}" class="page-btn next-page" title="下一页">
                    下一页 <i class="fas fa-angle-right"></i>
                </a>
            {% endif %}
        </div>
        <div class="page-info">
            第 {{ page_obj.number }} 页，共 {{ page_obj.paginator.num_pages }} 页
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}