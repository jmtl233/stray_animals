{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="user-profile-container">
    <div class="profile-header">
        <h2>我的个人信息</h2>
        <a href="#" class="btn btn--primary">编辑资料</a>
    </div>

    <div class="profile-content">
        <div class="avatar-section">
            <div class="avatar-preview">
                {% if user.avatar %}
                <img src="{{ user.avatar.url }}" alt="用户头像">
                {% else %}
                <div class="default-avatar">暂无头像</div>
                {% endif %}
            </div>
        </div>

        <div class="profile-details">
            <div class="detail-item">
                <label>用户名：</label>
                <span>{{ user.username }}</span>
            </div>
            <div class="detail-item">
                <label>电子邮箱：</label>
                <span>{{ user.email|default:"未填写" }}</span>
            </div>
            <div class="detail-item">
                <label>手机号码：</label>
                <span>{{ user.phone|default:"未填写" }}</span>
            </div>
            <div class="detail-item">
                <label>注册时间：</label>
                <span>{{ user.date_joined|date:"Y-m-d H:i" }}</span>
            </div>
        </div>
    </div>

    <!-- 新增领养记录部分 -->
    <div class="adoption-records">
        <h3>我的领养记录</h3>
        <div class="adoption-tabs">
            <button class="tab-btn active" data-tab="pending">待审核</button>
            <button class="tab-btn" data-tab="approved">已通过</button>
            <button class="tab-btn" data-tab="rejected">未通过</button>
        </div>

        <div class="adoption-content">
            <!-- 待审核申请 -->
            <div class="tab-pane active" id="pending">
                {% for application in pending_applications %}
                <div class="adoption-card">
                    <div class="pet-info">
                        <img src="{{ application.pet.photo.url }}" alt="{{ application.pet.name }}">
                        <div class="pet-details">
                            <h4>{{ application.pet.name }}</h4>
                            <p>品种：{{ application.pet.breed }}</p>
                            <p>申请时间：{{ application.apply_date|date:"Y-m-d" }}</p>
                        </div>
                    </div>
                    <div class="status-badge status-pending">审核中</div>
                </div>
                {% empty %}
                <p class="no-records">暂无待审核的申请</p>
                {% endfor %}
            </div>

            <!-- 已通过申请 -->
            <div class="tab-pane" id="approved">
                {% for application in approved_applications %}
                <div class="adoption-card">
                    <div class="pet-info">
                        <img src="{{ application.pet.photo.url }}" alt="{{ application.pet.name }}">
                        <div class="pet-details">
                            <h4>{{ application.pet.name }}</h4>
                            <p>品种：{{ application.pet.breed }}</p>
                            <p>领养时间：{{ application.approve_date|date:"Y-m-d" }}</p>
                        </div>
                    </div>
                    <div class="status-badge status-approved">已领养</div>
                </div>
                {% empty %}
                <p class="no-records">暂无已通过的申请</p>
                {% endfor %}
            </div>

            <!-- 未通过申请 -->
            <div class="tab-pane" id="rejected">
                {% for application in rejected_applications %}
                <div class="adoption-card">
                    <div class="pet-info">
                        <img src="{{ application.pet.photo.url }}" alt="{{ application.pet.name }}">
                        <div class="pet-details">
                            <h4>{{ application.pet.name }}</h4>
                            <p>品种：{{ application.pet.breed }}</p>
                            <p>申请时间：{{ application.apply_date|date:"Y-m-d" }}</p>
                            <p class="reject-reason">未通过原因：{{ application.reject_reason }}</p>
                        </div>
                    </div>
                    <div class="status-badge status-rejected">未通过</div>
                </div>
                {% empty %}
                <p class="no-records">暂无未通过的申请</p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %} 